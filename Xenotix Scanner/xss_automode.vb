Imports CefSharp.WinForms
Imports CefSharp


Public Class xss_automode
    Dim i As Integer = 0

 

    Private Sub Form4_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        On Error Resume Next
        tcount.Text = xenotix_main.RichTextBox1.Lines.Length
        Button3.Enabled = False
        Button4.Enabled = False
        Button5.Enabled = False
        Button6.Enabled = False

    End Sub

    Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click
        On Error Resume Next

        Me.Close()
    End Sub

    Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick
        On Error Resume Next
        ' xenotix_main.add_detection_timer.Enabled = True
        If (i <= xenotix_main.RichTextBox1.Lines.Length) Then
            If (i = xenotix_main.RichTextBox1.Lines.Length) Then
                cnt.Text = xenotix_main.RichTextBox1.Lines.Length
            Else
                cnt.Text = i + 1
            End If
            xenotix_main.textxss.Text = xenotix_main.RichTextBox1.Lines(i)
            xenotix_main.final.Text = (xenotix_main.turl.Text & xenotix_main.varx.Text & xenotix_main.textxss.Text)
            If xenotix_main.ie.Checked = True And xenotix_main.gc.Checked = True And xenotix_main.ff.Checked = True Then
                xenotix_main.web.Url = New Uri(xenotix_main.final.Text)
                xenotix_main.gecko.Navigate(xenotix_main.final.Text)
                xenotix_main.webkit.Load(xenotix_main.final.Text)
            ElseIf xenotix_main.ie.Checked = False And xenotix_main.gc.Checked = False And xenotix_main.ff.Checked = False Then
                MsgBox("Select atleast 1 Browser Engine", vbInformation)

                Me.Close()
            ElseIf xenotix_main.ie.Checked = True And xenotix_main.gc.Checked = True And xenotix_main.ff.Checked = False Then
                xenotix_main.web.Url = New Uri(xenotix_main.final.Text)
                xenotix_main.webkit.Load(xenotix_main.final.Text)
            ElseIf xenotix_main.ie.Checked = True And xenotix_main.gc.Checked = False And xenotix_main.ff.Checked = False Then
                xenotix_main.web.Url = New Uri(xenotix_main.final.Text)
            ElseIf xenotix_main.ie.Checked = True And xenotix_main.gc.Checked = False And xenotix_main.ff.Checked = True Then
                xenotix_main.web.Url = New Uri(xenotix_main.final.Text)
                xenotix_main.gecko.Navigate(xenotix_main.final.Text)
            ElseIf xenotix_main.ie.Checked = False And xenotix_main.gc.Checked = False And xenotix_main.ff.Checked = True Then
                xenotix_main.gecko.Navigate(xenotix_main.final.Text)
            ElseIf xenotix_main.ie.Checked = False And xenotix_main.gc.Checked = True And xenotix_main.ff.Checked = False Then
                xenotix_main.webkit.Load(xenotix_main.final.Text)
            ElseIf xenotix_main.ie.Checked = False And xenotix_main.gc.Checked = True And xenotix_main.ff.Checked = True Then
                xenotix_main.gecko.Navigate(xenotix_main.final.Text)
                xenotix_main.webkit.Load(xenotix_main.final.Text)
            End If

            i = i + 1
        Else
            Timer1.Enabled = False
            MsgBox("Test Finished!", vbInformation)
            Button3.Enabled = False
            Button4.Enabled = False
            Button5.Enabled = False
            Button6.Enabled = False
            i = 0
            cnt.Text = i
        End If


    End Sub



    Private Sub Button1_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        On Error Resume Next
        Me.TopMost = True
        If Not (xenotix_main.turl.Text.Contains("http://") Or xenotix_main.turl.Text.Contains("https://")) Or xenotix_main.turl.Text = "" Then
            MsgBox("Invalid URL!", vbCritical)

        Else
            If Integer.Parse(TextBox1.Text) < 2 Then
                MsgBox("Time interval should be greater than 1 sec", vbInformation)
            Else
                Dim t As Integer = Convert.ToInt32(TextBox1.Text)
                t = t * 1000
                Timer1.Interval = t
                Timer1.Enabled = True
                Button3.Enabled = True
                Button4.Enabled = True
                Button5.Enabled = True
                Button6.Enabled = True
            End If
        End If

    End Sub

    Private Sub Button4_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button4.Click

        On Error Resume Next
        If i <= tcount.Text Then
            i = i + 1
            cnt.Text = i + 1
        End If

    End Sub

    Private Sub Button5_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button5.Click
        On Error Resume Next
        Dim x As Integer = InputBox("Enter the Payload position index", "Skip to Payload")

        If x <= tcount.Text Then
            i = x
            cnt.Text = x
        Else
            MsgBox("Invalid Payload index!", vbCritical)
        End If
    End Sub

    Private Sub Button6_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button6.Click
        On Error Resume Next
        Timer1.Enabled = True
        Button6.Visible = False
        Button3.Visible = True
    End Sub


    Private Sub Button3_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button3.Click
        On Error Resume Next
        Timer1.Enabled = False
        Button3.Visible = False
        Button6.Visible = True
    End Sub
End Class