Imports CefSharp.WinForms
Imports CefSharp


Public Class xss_get_manual

    Dim i As Integer = 0

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        On Error Resume Next
        Me.TopMost = True
        ' xenotix_main.add_detection_timer.Enabled = True

        If Not (xenotix_main.turl.Text.Contains("http://") Or xenotix_main.turl.Text.Contains("https://")) Or xenotix_main.turl.Text = "" Then
            MsgBox("Invalid URL!", vbCritical)
        Else
            Button1.Text = "Next Payload"
            If (i = xenotix_main.RichTextBox1.Lines.Length) Then
                cnt.Text = xenotix_main.RichTextBox1.Lines.Length
            Else
                cnt.Text = i + 1
            End If
            xenotix_main.textxss.Text = xenotix_main.RichTextBox1.Lines(i)
            xenotix_main.final.Text = (xenotix_main.turl.Text & xenotix_main.varx.Text & xenotix_main.textxss.Text)
            If xenotix_main.ie.Checked = True And xenotix_main.gc.Checked = True And xenotix_main.ff.Checked = True Then
                xenotix_main.web.Url = New Uri(xenotix_main.final.Text)
                xenotix_main.gecko.Navigate(xenotix_main.final.Text)
                xenotix_main.webkit.Load(xenotix_main.final.Text)
            ElseIf xenotix_main.ie.Checked = False And xenotix_main.gc.Checked = False And xenotix_main.ff.Checked = False Then
                MsgBox("Select atleast 1 Browser Engine", vbInformation)

                Me.Close()
            ElseIf xenotix_main.ie.Checked = True And xenotix_main.gc.Checked = True And xenotix_main.ff.Checked = False Then
                xenotix_main.web.Url = New Uri(xenotix_main.final.Text)
                xenotix_main.webkit.Load(xenotix_main.final.Text)
            ElseIf xenotix_main.ie.Checked = True And xenotix_main.gc.Checked = False And xenotix_main.ff.Checked = False Then
                xenotix_main.web.Url = New Uri(xenotix_main.final.Text)
            ElseIf xenotix_main.ie.Checked = True And xenotix_main.gc.Checked = False And xenotix_main.ff.Checked = True Then
                xenotix_main.web.Url = New Uri(xenotix_main.final.Text)
                xenotix_main.gecko.Navigate(xenotix_main.final.Text)
            ElseIf xenotix_main.ie.Checked = False And xenotix_main.gc.Checked = False And xenotix_main.ff.Checked = True Then
                xenotix_main.gecko.Navigate(xenotix_main.final.Text)
            ElseIf xenotix_main.ie.Checked = False And xenotix_main.gc.Checked = True And xenotix_main.ff.Checked = False Then
                xenotix_main.webkit.Load(xenotix_main.final.Text)
            ElseIf xenotix_main.ie.Checked = False And xenotix_main.gc.Checked = True And xenotix_main.ff.Checked = True Then
                xenotix_main.gecko.Navigate(xenotix_main.final.Text)
                xenotix_main.webkit.Load(xenotix_main.final.Text)
            End If


            i = i + 1
            If (i > xenotix_main.RichTextBox1.Lines.Length) Then

                MsgBox("Scan Finished!", vbInformation)
                i = 0
                cnt.Text = i
            End If
        End If
    End Sub

    Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click
        On Error Resume Next

        Me.Close()
    End Sub

    Private Sub Form2_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

        On Error Resume Next
        Button1.Text = "Scan"
        tcount.Text = xenotix_main.RichTextBox1.Lines.Length
    End Sub

    Private Sub Label2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cnt.Click

    End Sub

    Private Sub RichTextBox1_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

End Class